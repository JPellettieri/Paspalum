library(readxl)
CJB_Datos_concurso_jovenes_de_bioestadistica <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
View(CJB_Datos_concurso_jovenes_de_bioestadistica)
Crudos <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
summary(Crudos)
str(crudos)
crudos <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
summary(crudos)
str(crudos)
#veo si esta balanceado entre tratamientos
table(crudos$Año)
table(crudos$Localidad)
table(crudos$Línea)
# Cruce Línea x Localidad
table(crudos$Línea, crudos$Localidad)
# Cruce Año x Localidad
table(crudos$Año, crudos$Localidad)
# Cruce Año x Línea
table(crudos$Año, crudos$Línea)
# Cruce triple Año x Localidad x Línea
xtabs(~ Año + Localidad + Línea, data = crudos)
# Cruce triple Año x Localidad x Línea
xtabs(~ Año + Localidad + Línea, data = crudos)
###Comienzo analisis exploratorio en orden de las preguntas
#  1.	¿Existen diferencias significativas entre híbridos en la producción total y en su distribución a lo largo del tiempo?
# Osea vamos a ver cuanto produce cada hibrido en cada luagar en cada temporada y tambien ver en q corte es mayor la produccion
crudos %>%
group_by(Año, Localidad, Línea, Corte) %>%
summarise(PF_mean = mean(PF, na.rm=TRUE),
PF_se = sd(PF, na.rm=TRUE)/sqrt(n())) %>%
ggplot(aes(x = Corte, y = PF_mean, color = Línea, group = Línea)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = PF_mean - PF_se, ymax = PF_mean + PF_se), width = 0.2) +
facet_wrap(~Localidad) +
labs(y = "Producción de forraje (g MS/m)", title = "Trayectoria temporal de PF por híbrido")
library(dplyr)
library(purrr)
library(ggplot2)
library(MuMIn)
library(tidyr)
library(tidyverse)
library(broom)
library(lme4)
library(scales)
library(glmmTMB)
library(DHARMa)
library(emmeans)
###Comienzo analisis exploratorio en orden de las preguntas
#  1.	¿Existen diferencias significativas entre híbridos en la producción total y en su distribución a lo largo del tiempo?
# Osea vamos a ver cuanto produce cada hibrido en cada luagar en cada temporada y tambien ver en q corte es mayor la produccion
crudos %>%
group_by(Año, Localidad, Línea, Corte) %>%
summarise(PF_mean = mean(PF, na.rm=TRUE),
PF_se = sd(PF, na.rm=TRUE)/sqrt(n())) %>%
ggplot(aes(x = Corte, y = PF_mean, color = Línea, group = Línea)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = PF_mean - PF_se, ymax = PF_mean + PF_se), width = 0.2) +
facet_wrap(~Localidad) +
labs(y = "Producción de forraje (g MS/m)", title = "Trayectoria temporal de PF por híbrido")
datos_largos <- crudos %>%
pivot_longer(cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)") %>%
filter(!is.na(PF), Corte != "Total")
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
#configuro los datos para hacer analisis exploratorios
datos_largos <- crudos %>%
pivot_longer(cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)") %>%
filter(!is.na(PF), Corte != "Total")
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
ggplot(datos_largos, aes(x = Corte, y = PF, color = Línea, group = Línea)) +
stat_summary(fun = mean, geom = "line", size = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
datos_relativos <- datos_largos %>%
left_join(crudos %>% select(Línea, `PF Total`), by = "Línea") %>%
mutate(PF_rel = PF / `PF Total` * 100)
ggplot(datos_relativos, aes(x = Corte, y = PF_rel, fill = Línea)) +
geom_boxplot(alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "% del total de forraje", x = "Corte")
#configuro los datos para hacer analisis exploratorios
datos_largos <- crudos %>%
pivot_longer(cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)") %>%
filter(!is.na(PF), Corte != "Total", Corte != "total")
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
library(dplyr)
library(purrr)
library(ggplot2)
library(MuMIn)
library(tidyr)
library(tidyverse)
library(broom)
library(lme4)
library(scales)
library(glmmTMB)
library(DHARMa)
library(emmeans)
crudos <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
crudos <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
library(readxl)
crudos <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
summary(crudos)
#veo si esta balanceado entre tratamientos
table(crudos$Año)
table(crudos$Localidad)
table(crudos$Línea)
# Cruce Línea x Localidad x año
xtabs(~ Año + Localidad + Línea, data = crudos)
#configuro los datos para hacer analisis exploratorios
datos_largos <- crudos %>%
pivot_longer(cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)") %>%
filter(!is.na(PF), Corte != "Total", Corte != "total")
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
#configuro los datos para hacer analisis exploratorios
datos_largos <- crudos %>%
names_to = "Corte",
names_pattern = "PF (.*)") %>%
#configuro los datos para hacer analisis exploratorios
datos_largos <- crudos %>%
pivot_longer(cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)") %>%
filter(!is.na(PF), Corte != ("Total","total.°C","total.mm","total.d"))
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
#configuro los datos para hacer analisis exploratorios
datos_largos <- crudos %>%
pivot_longer(
cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)"
) %>%
filter(!is.na(PF),
!Corte %in% c("Total", "total.°C", "total.mm", "total.d"))
crudos <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
summary(crudos)
#veo si esta balanceado entre tratamientos
table(crudos$Año)
table(crudos$Localidad)
table(crudos$Línea)
# Cruce Línea x Localidad x año
xtabs(~ Año + Localidad + Línea, data = crudos)
#configuro los datos para hacer analisis exploratorios
datos_largos <- crudos %>%
pivot_longer(
cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)"
) %>%
filter(!is.na(PF),
!Corte %in% c("Total", "total.°C", "total.mm", "total.d"))
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
#configuro los datos para hacer analisis exploratorios
datos_largos <- crudos %>%
pivot_longer(
cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)"
) %>%
filter(!is.na(PF),
!Corte %in% c("Total", "total.ºC", "total.mm", "total.d"))
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
ggplot(datos_largos, aes(x = Corte, y = PF, color = Línea, group = Línea)) +
stat_summary(fun = mean, geom = "line", size = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
####    VARIABLES  ####
#Hay una banda de variables muchas surgen de cuentas hechas a partir de otras, en el doc hay un glosario de variables
#A grandes razgos los aspectos q se evaluaron fueron:
#Pl/m: Plántulas por metro lineal de surco: Entiendo que se refiere a la cantidad de plantulas q se pusieron en un principio en cada sitio, en dicho caso tiene sentido que RELATIVICEMOS todos los resultados a la cantidad inicial de plantulas de cada sitio!
xtabs(~ Año + Localidad + Línea + Pl/m, data = crudos)
####    VARIABLES  ####
#Hay una banda de variables muchas surgen de cuentas hechas a partir de otras, en el doc hay un glosario de variables
#A grandes razgos los aspectos q se evaluaron fueron:
#Pl/m: Plántulas por metro lineal de surco: Entiendo que se refiere a la cantidad de plantulas q se pusieron en un principio en cada sitio, en dicho caso tiene sentido que RELATIVICEMOS todos los resultados a la cantidad inicial de plantulas de cada sitio!
Plantulas <- crudos %>%
group_by(Año, Localidad, Línea) %>%
summarise(Pl_m = unique(Pl_m))  # o mean(Pl_m) si hay más de un valor
####    VARIABLES  ####
#Hay una banda de variables muchas surgen de cuentas hechas a partir de otras, en el doc hay un glosario de variables
#A grandes razgos los aspectos q se evaluaron fueron:
#Pl/m: Plántulas por metro lineal de surco: Entiendo que se refiere a la cantidad de plantulas q se pusieron en un principio en cada sitio, en dicho caso tiene sentido que RELATIVICEMOS todos los resultados a la cantidad inicial de plantulas de cada sitio!
Plantulas <- crudos %>%
group_by(Año, Localidad, Línea) %>%
summarise(Pl/m = unique(Pl/m))  # o mean(Pl_m) si hay más de un valor
####    VARIABLES  ####
#Hay una banda de variables muchas surgen de cuentas hechas a partir de otras, en el doc hay un glosario de variables
#A grandes razgos los aspectos q se evaluaron fueron:
#Pl/m: Plántulas por metro lineal de surco: Entiendo que se refiere a la cantidad de plantulas q se pusieron en un principio en cada sitio, en dicho caso tiene sentido que RELATIVICEMOS todos los resultados a la cantidad inicial de plantulas de cada sitio!
Plantulas <- crudos %>%
group_by(Año, Localidad, Línea) %>%
summarise(Pl/m = mean(Pl/m))  # o mean(Pl_m) si hay más de un valor
####    VARIABLES  ####
#Hay una banda de variables muchas surgen de cuentas hechas a partir de otras, en el doc hay un glosario de variables
#A grandes razgos los aspectos q se evaluaron fueron:
#Pl/m: Plántulas por metro lineal de surco: Entiendo que se refiere a la cantidad de plantulas q se pusieron en un principio en cada sitio, en dicho caso tiene sentido que RELATIVICEMOS todos los resultados a la cantidad inicial de plantulas de cada sitio!
Plantulas <- crudos %>%
group_by(Año, Localidad, Línea) %>%
summarise(Pl/m == mean(Pl/m))  # o mean(Pl_m) si hay más de un valor
####    VARIABLES  ####
#Hay una banda de variables muchas surgen de cuentas hechas a partir de otras, en el doc hay un glosario de variables
#A grandes razgos los aspectos q se evaluaron fueron:
#Pl/m: Plántulas por metro lineal de surco: Entiendo que se refiere a la cantidad de plantulas q se pusieron en un principio en cada sitio, en dicho caso tiene sentido que RELATIVICEMOS todos los resultados a la cantidad inicial de plantulas de cada sitio!
Plantulas <- crudos %>%
group_by(Año, Localidad, Línea) %>%
summarise(Pl/m = mean(Pl/m))  # o mean(Pl_m) si hay más de un valor
####    VARIABLES  ####
#Hay una banda de variables muchas surgen de cuentas hechas a partir de otras, en el doc hay un glosario de variables
#A grandes razgos los aspectos q se evaluaron fueron:
#Pl/m: Plántulas por metro lineal de surco: Entiendo que se refiere a la cantidad de plantulas q se pusieron en un principio en cada sitio, en dicho caso tiene sentido que RELATIVICEMOS todos los resultados a la cantidad inicial de plantulas de cada sitio!
Plantulas <- crudos %>%
group_by(Año, Localidad, Línea) %>%
summarise(Pl_m = mean(`Pl/m`, na.rm = TRUE)) # Es una paja que la variable tenga / habria que sacarsela a todas las varibles, podemos poner _ en su lugar
View(Plantulas)
print(Plantulas)
print(crudos$`Pl/m`)
tabla_valores <- Plantulas %>%
select(Año, Localidad, Línea, Pl_m) %>%
pivot_wider(
names_from = Localidad,
values_from = Pl_m
)
View(tabla_valores)
## a chequear, puse sulo años 23-24 y relativizado a cantidad inicial de plantulas
datos_largos <- crudos %>%
pivot_longer(
cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)"
) %>%
filter(!is.na(PF),
!Corte %in% c("Total", "total.ºC", "total.mm", "total.d")) %>%
filter(Año == "23-24") %>%                      # solo ciclo 23-24
mutate(PF_rel = PF / `Pl/m`)                    # relativizado por plantas/m
# Boxplots relativizados
ggplot(datos_largos, aes(x = Corte, y = PF_rel, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción relativa (g MS / planta)", x = "Corte")
# Línea con medias relativizadas
ggplot(datos_largos, aes(x = Corte, y = PF_rel, color = Línea, group = Línea)) +
stat_summary(fun = mean, geom = "line", size = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
theme_minimal() +
labs(y = "Producción relativa (g MS / planta)", x = "Corte")
