library(readxl)
CJB_Datos_concurso_jovenes_de_bioestadistica <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
View(CJB_Datos_concurso_jovenes_de_bioestadistica)
Crudos <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
summary(Crudos)
str(crudos)
crudos <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
summary(crudos)
str(crudos)
#veo si esta balanceado entre tratamientos
table(crudos$Año)
table(crudos$Localidad)
table(crudos$Línea)
# Cruce Línea x Localidad
table(crudos$Línea, crudos$Localidad)
# Cruce Año x Localidad
table(crudos$Año, crudos$Localidad)
# Cruce Año x Línea
table(crudos$Año, crudos$Línea)
# Cruce triple Año x Localidad x Línea
xtabs(~ Año + Localidad + Línea, data = crudos)
# Cruce triple Año x Localidad x Línea
xtabs(~ Año + Localidad + Línea, data = crudos)
###Comienzo analisis exploratorio en orden de las preguntas
#  1.	¿Existen diferencias significativas entre híbridos en la producción total y en su distribución a lo largo del tiempo?
# Osea vamos a ver cuanto produce cada hibrido en cada luagar en cada temporada y tambien ver en q corte es mayor la produccion
crudos %>%
group_by(Año, Localidad, Línea, Corte) %>%
summarise(PF_mean = mean(PF, na.rm=TRUE),
PF_se = sd(PF, na.rm=TRUE)/sqrt(n())) %>%
ggplot(aes(x = Corte, y = PF_mean, color = Línea, group = Línea)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = PF_mean - PF_se, ymax = PF_mean + PF_se), width = 0.2) +
facet_wrap(~Localidad) +
labs(y = "Producción de forraje (g MS/m)", title = "Trayectoria temporal de PF por híbrido")
library(dplyr)
library(purrr)
library(ggplot2)
library(MuMIn)
library(tidyr)
library(tidyverse)
library(broom)
library(lme4)
library(scales)
library(glmmTMB)
library(DHARMa)
library(emmeans)
###Comienzo analisis exploratorio en orden de las preguntas
#  1.	¿Existen diferencias significativas entre híbridos en la producción total y en su distribución a lo largo del tiempo?
# Osea vamos a ver cuanto produce cada hibrido en cada luagar en cada temporada y tambien ver en q corte es mayor la produccion
crudos %>%
group_by(Año, Localidad, Línea, Corte) %>%
summarise(PF_mean = mean(PF, na.rm=TRUE),
PF_se = sd(PF, na.rm=TRUE)/sqrt(n())) %>%
ggplot(aes(x = Corte, y = PF_mean, color = Línea, group = Línea)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = PF_mean - PF_se, ymax = PF_mean + PF_se), width = 0.2) +
facet_wrap(~Localidad) +
labs(y = "Producción de forraje (g MS/m)", title = "Trayectoria temporal de PF por híbrido")
datos_largos <- crudos %>%
pivot_longer(cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)") %>%
filter(!is.na(PF), Corte != "Total")
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
#configuro los datos para hacer analisis exploratorios
datos_largos <- crudos %>%
pivot_longer(cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)") %>%
filter(!is.na(PF), Corte != "Total")
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
ggplot(datos_largos, aes(x = Corte, y = PF, color = Línea, group = Línea)) +
stat_summary(fun = mean, geom = "line", size = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
datos_relativos <- datos_largos %>%
left_join(crudos %>% select(Línea, `PF Total`), by = "Línea") %>%
mutate(PF_rel = PF / `PF Total` * 100)
ggplot(datos_relativos, aes(x = Corte, y = PF_rel, fill = Línea)) +
geom_boxplot(alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "% del total de forraje", x = "Corte")
