VEF: Genotipo ambiente Genotipo*Ambiente  # Ver si da significativa la interaccion
VA: Año",
#  2.	¿Existen diferencias entre híbridos en la distribución de la producción de forraje y la producción total acumulada?
"VR: produccion total/ dias a produccion total,   TC dia 1/2/3/4, TC°C 1/2/3/4 y TC mm
VEF: Genotipo  # Ver si da significativa la interaccion
VA: Año, Localidad",
#  3.	¿Existen diferencias entre las localidades en la distribución de la producción de forraje y la producción total acumulada?
"VR: produccion total/ dias a produccion total,   TC dia 1/2/3/4
VEF: Localidad  # Ver si da significativa la interaccion
VA: Año, Genotipo",
#  4.	¿El uso de tasas de acumulación (por día, grado-día o mm de precipitación) permite corregir las diferencias entre frecuencias de cortes (periodo de tiempo transcurrido entre cortes sucesivos) y diferencias ambientales entre localidades?
"Dos ideas:
3 Modelos:
VEF (una por modelo): TC dias, TC mm y TC °C.
VA: Lugar", # La idea es ver si la varianza explicada por lugar es similar a la explicada por bloque. Dia deberia tener maxima Varianza entre lugares e ir disminuyendo con °C o mm.
#Si con °C o mm la varianza entre bloques es similar a entre sitios entonces puedo quedarme tranqui de que mm o °C es una buena forma de relativizar.
#No estoy segura de que se pueda poner como VA a bloque en dicho caso puedo ver de la varianza relativa Varianza explicada por VA/ varianza residual
#  5.	¿Existen diferencias entre híbridos en la densidad de inflorescencias, producción de semillas y porcentaje de llenado de semillas?
"Medio que ya lo hicimos antes, habria q ver de encarar huntas las preguntas y despues ir al detalle y ya",
#  6.	¿Existen diferencias entre las localidades en la densidad de inflorescencias, producción de semillas y porcentaje de llenado de semillas?
"same shit",
#  7.	Cuál sería el mejor híbrido y cuál sería la localidad más apropiada para la producción de semillas?
"aca conclu con las dif sig etc no es la combinacion!" # tener en cuenta cuantas de las semillas dieron plantulas?
)
#configuro los datos para hacer analisis exploratorios
datos_largos <- relativos %>%
pivot_longer(
cols = starts_with("PF "),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)"
) %>%
filter(!is.na(PF),
!Corte %in% c("Total", "total.ºC", "total.mm", "total.d"))
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
#los boxplots muestran distribucion bastante normal
ggplot(datos_largos, aes(x = Corte, y = PF, color = Línea, group = Línea)) +
stat_summary(fun = mean, geom = "line", size = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
theme_minimal() +
labs(y = "Producción de forraje (g MS/m)", x = "Corte")
# 2) Creamos la base 'relativos'
relativos <- crudos %>%
left_join(plantas_ref, by = c("Localidad", "Línea", "Bloque")) %>%
mutate(
# usamos siempre Pl/m de 23-24 como denominador
Pl_m_usada = ifelse(Año == "24-25", Pl_m_ref, `Pl/m`)
) %>%
# 3) Dividimos todas las variables numéricas (excepto Pl/m y las auxiliares)
mutate(across(
where(is.numeric) & !c("Pl/m","Pl_m_ref","Pl_m_usada"),
~ .x / Pl_m_usada
)) %>%
# 4) Limpiamos auxiliares si no se quieren guardar
select(-Pl_m_ref, -Pl_m_usada)
# Paso a factor las variables que crrespondan
crudos$Bloque<- as.factor(crudos$Bloque)
#veo si esta balanceado entre tratamientos
table(crudos$Año)
table(crudos$Localidad)
table(crudos$Línea)
# Cruce Línea x Localidad x año
xtabs(~ Año + Localidad + Línea, data = crudos)
####    VARIABLES  ####
#Hay una banda de variables muchas surgen de cuentas hechas a partir de otras, en el doc hay un glosario de variables
#A grandes razgos los aspectos q se evaluaron fueron:
#Pl/m: Plántulas por metro lineal de surco: Entiendo que se refiere a la cantidad de plantulas q se pusieron en un principio en cada sitio, en dicho caso tiene sentido que RELATIVICEMOS todos los resultados a la cantidad inicial de plantulas de cada sitio!
Plantulas <- crudos %>%
group_by(Año, Localidad, Línea) %>%
summarise(Pl_m = mean(`Pl/m`, na.rm = TRUE)) # Es una paja que la variable tenga / habria que sacarsela a todas las varibles, podemos poner _ en su lugar
print(Plantulas)
#alv faltan un monton de datos, faltan todos los de 2024 - 2025, ademas no todas las lineas tienen las mismas plantulas iniciales asique vamos a tener que relativizar!
tabla_valores <- Plantulas %>%
select(Año, Localidad, Línea, Pl_m) %>%
pivot_wider(
names_from = Localidad,
values_from = Pl_m
)
# 1) Tomamos como referencia la densidad de plantas (Pl/m) de 23-24
plantas_ref <- crudos %>%
filter(Año == "23-24") %>%
group_by(Localidad, Línea, Bloque) %>%
summarise(Pl_m_ref = mean(`Pl/m`, na.rm = TRUE), .groups = "drop")
# 2) Creamos la base 'relativos'
relativos <- crudos %>%
left_join(plantas_ref, by = c("Localidad", "Línea", "Bloque")) %>%
mutate(
# usamos siempre Pl/m de 23-24 como denominador
Pl_m_usada = ifelse(Año == "24-25", Pl_m_ref, `Pl/m`)
) %>%
# 3) Dividimos todas las variables numéricas (excepto Pl/m y las auxiliares)
mutate(across(
where(is.numeric) & !c("Pl/m","Pl_m_ref","Pl_m_usada"),
~ .x / Pl_m_usada
)) %>%
# 4) Limpiamos auxiliares si no se quieren guardar
select(-Pl_m_ref, -Pl_m_usada)
# 2) Creamos la base 'relativos'
relativos <- crudos %>%
left_join(plantas_ref, by = c("Localidad", "Línea", "Bloque")) %>%
mutate(
# usamos siempre Pl/m de 23-24 como denominador
Pl_m_usada = ifelse(Año == "24-25", Pl_m_ref, `Pl/m`)
) %>%
# 3) Dividimos todas las variables numéricas (excepto Pl/m y las auxiliares)
mutate(across(
where(is.numeric) & !c("Pl/m","Pl_m_ref","Pl_m_usada"),
~ .x / Pl_m_usada
)) %>%
# 4) Limpiamos auxiliares si no se quieren guardar
select(-Pl_m_ref, -Pl_m_usada)
crudos <- read_excel("CJB_Datos concurso jovenes de bioestadistica.xlsx")
summary(crudos)
# Paso a factor las variables que crrespondan
crudos$Bloque<- as.factor(crudos$Bloque)
#veo si esta balanceado entre tratamientos
table(crudos$Año)
table(crudos$Localidad)
table(crudos$Línea)
# Cruce Línea x Localidad x año
xtabs(~ Año + Localidad + Línea, data = crudos)
####    VARIABLES  ####
#Hay una banda de variables muchas surgen de cuentas hechas a partir de otras, en el doc hay un glosario de variables
#A grandes razgos los aspectos q se evaluaron fueron:
#Pl/m: Plántulas por metro lineal de surco: Entiendo que se refiere a la cantidad de plantulas q se pusieron en un principio en cada sitio, en dicho caso tiene sentido que RELATIVICEMOS todos los resultados a la cantidad inicial de plantulas de cada sitio!
Plantulas <- crudos %>%
group_by(Año, Localidad, Línea) %>%
summarise(Pl_m = mean(`Pl/m`, na.rm = TRUE)) # Es una paja que la variable tenga / habria que sacarsela a todas las varibles, podemos poner _ en su lugar
print(Plantulas)
#alv faltan un monton de datos, faltan todos los de 2024 - 2025, ademas no todas las lineas tienen las mismas plantulas iniciales asique vamos a tener que relativizar!
tabla_valores <- Plantulas %>%
select(Año, Localidad, Línea, Pl_m) %>%
pivot_wider(
names_from = Localidad,
values_from = Pl_m
)
## a chequear y relativizado a cantidad inicial de plantulas
datos_largos_PF <- relativos %>%
pivot_longer(
cols = c("PF 1", "PF 2", "PF 3", "PF 4"),
names_to = "Corte",
values_to = "PF",
names_pattern = "PF (.*)"
) %>%
mutate(,
Corte = factor(Corte, levels = c("1","2","3","4"))) %>%
select(Año, Localidad, Línea, Bloque, Corte, PF)
tablas_PF_por_sitio
# Boxplots relativizados
ggplot(datos_largos, aes(x = Corte, y = PF, fill = Línea)) +
geom_boxplot(outlier.shape = NA, alpha = 0.7) +
facet_wrap(~Línea) +
theme_minimal() +
labs(y = "Producción relativa (g MS / planta)", x = "Corte")
# Línea con medias relativizadas
ggplot(datos_largos, aes(x = Corte, y = PF, color = Línea, group = Línea)) +
stat_summary(fun = mean, geom = "line", size = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
theme_minimal() +
labs(y = "Producción relativa (g MS / planta)", x = "Corte")
ggplot(datos_largos, aes(x = Corte, y = PF, color = Línea, group = Línea)) +
stat_summary(fun = mean, geom = "line", linewidth = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
facet_wrap(~Localidad) +
theme_minimal() +
labs(y = "Producción relativa (g MS / planta)",
x = "Corte",
title = "Medias de PF relativa por corte y línea en cada localidad")
### TEMPERATURA: ####
datos_TC <- relativos %>%
pivot_longer(
cols = matches("^TC\\d [1-4]$"),    # columnas TC.ºC 1,2,3,4
names_to = "Corte",
values_to = "TC"
) %>%
filter(!is.na(TC))%>%
mutate(                         # relativizado por plantas
Corte = factor(gsub("TC.ºC ", "", Corte),      # dejar solo número de corte
levels = c("1", "2", "3", "4"))  # porque la 4 no sale en los grafico :( ??
)
# 2) Creamos la base 'relativos'
relativos <- crudos %>%
left_join(plantas_ref, by = c("Localidad", "Línea", "Bloque")) %>%
mutate(
# usamos siempre Pl/m de 23-24 como denominador
Pl_m_usada = ifelse(Año == "24-25", Pl_m_ref, `Pl/m`)
) %>%
# 3) Dividimos todas las variables numéricas (excepto Pl/m y las auxiliares)
mutate(across(
where(is.numeric) & !c("Pl/m","Pl_m_ref","Pl_m_usada"),
~ .x / Pl_m_usada
)) %>%
# 4) Limpiamos auxiliares si no se quieren guardar
select(-Pl_m_ref, -Pl_m_usada)
# 1) Tomamos como referencia la densidad de plantas (Pl/m) de 23-24
plantas_ref <- crudos %>%
filter(Año == "23-24") %>%
group_by(Localidad, Línea, Bloque) %>%
summarise(Pl_m_ref = mean(`Pl/m`, na.rm = TRUE), .groups = "drop")
# 2) Creamos la base 'relativos'
relativos <- crudos %>%
left_join(plantas_ref, by = c("Localidad", "Línea", "Bloque")) %>%
mutate(
# usamos siempre Pl/m de 23-24 como denominador
Pl_m_usada = ifelse(Año == "24-25", Pl_m_ref, `Pl/m`)
) %>%
# 3) Dividimos todas las variables numéricas (excepto Pl/m y las auxiliares)
mutate(across(
where(is.numeric) & !c("Pl/m","Pl_m_ref","Pl_m_usada"),
~ .x / Pl_m_usada
)) %>%
# 4) Limpiamos auxiliares si no se quieren guardar
#select(-Pl_m_ref, -Pl_m_usada)
#### Exploratorio de cantidad de plantulas q crecieron en cada lugar con cada linea ####
datos_plot <- crudos %>%
filter(!is.na(`Pl/m`)) %>%
group_by(Localidad, Línea) %>%
summarise(
mean_pl = mean(`Pl/m`, na.rm = TRUE),
se_pl = sd(`Pl/m`, na.rm = TRUE) / sqrt(n()),
.groups = "drop"
)
# 2) Creamos la base 'relativos'
relativos <- crudos %>%
left_join(plantas_ref, by = c("Localidad", "Línea", "Bloque")) %>%
mutate(
# usamos siempre Pl/m de 23-24 como denominador
Pl_m_usada = ifelse(Año == "24-25", Pl_m_ref, `Pl/m`)
) %>%
# 3) Dividimos todas las variables numéricas (excepto Pl/m y las auxiliares)
mutate(across(
where(is.numeric) & !c("Pl/m","Pl_m_ref","Pl_m_usada"),
~ .x / Pl_m_usada
))
View(relativos)
View(crudos)
DMR_Linea <- lmer(DMR ~ Línea + (1|Localidad) + (1|Año), data = relativos)
summary(DMR_Linea)
anova(DMR_Linea)  #Si
REL_DMR_Linea <- lmer(DMR ~ Línea + (1|Localidad) + (1|Año), data = relativos)
summary(REL_DMR_Linea)
anova(REL_DMR_Linea)  #Si
emm_lineas <- emmeans(REL_DMR_Linea, ~ Línea) #contraste
pairs(emm_lineas, adjust = "tukey") #J7-L37 y J7-UF93
#grafiquito
emm_lineas <- emmeans(REL_DMR_Linea, ~ Línea) # Medias estimadas de DMR por Línea
cld_lineas <- multcomp::cld(emm_lineas, Letters = letters, adjust = "tukey")
df_plot <- as.data.frame(cld_lineas)
ggplot(df_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias (DMR, predicho)",
title = "Medias estimadas de DMR por línea"
) +
theme_minimal(base_size = 13)
## Hay dif sig entre lineas? #sin relastivizar
DMR_Linea <- lmer(DMR ~ Línea + (1|Localidad) + (1|Año), data = crudos)
summary(DMR_Linea)
anova(DMR_Linea)  #Si
emm_lineas <- emmeans(DMR_Linea, ~ Línea) #contraste
pairs(emm_lineas, adjust = "tukey") #J7-L37 y J7-UF93
#grafiquito
emm_lineas <- emmeans(DMR_Linea, ~ Línea) # Medias estimadas de DMR por Línea
cld_lineas <- multcomp::cld(emm_lineas, Letters = letters, adjust = "tukey")
df_plot <- as.data.frame(cld_lineas)
ggplot(df_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias (DMR, predicho)",
title = "Medias estimadas de DMR por línea"
) +
theme_minimal(base_size = 13)
#grafiquito
emm_lineas <- emmeans(REL_DMR_Linea, ~ Línea) # Medias estimadas de DMR por Línea
cld_lineas <- multcomp::cld(emm_lineas, Letters = letters, adjust = "tukey")
df_plot <- as.data.frame(cld_lineas)
ggplot(df_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias relativizado a la cantidad de plantulas",
title = "Medias estimadas de DMR"
) +
theme_minimal(base_size = 13)
emm_lineas <- emmeans(REL_DMR_Linea, ~ Línea) #contraste
pairs(emm_lineas, adjust = "tukey") #J7-L37 y J7-UF93
pairs(emm_lineas, adjust = "tukey") #J7-L37 y J7-UF93
## RELATIVIZADO A CANTIDAD DE PLANTULAS
REL_DMR_Linea <- lmer(DMR ~ Línea + (1|Localidad) + (1|Año), data = relativos)
summary(REL_DMR_Linea)
anova(REL_DMR_Linea)  #Si
Remm_lineas <- emmeans(REL_DMR_Linea, ~ Línea) #contraste
pairs(Remm_lineas, adjust = "tukey") #J7-L37 y J7-UF93
#grafiquito
Remm_lineas <- emmeans(REL_DMR_Linea, ~ Línea) # Medias estimadas de DMR por Línea
Rcld_lineas <- multcomp::cld(Remm_lineas, Letters = letters, adjust = "tukey")
Rdf_plot <- as.data.frame(Rcld_lineas)
ggplot(Rdf_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias relativizado a la cantidad de plantulas",
title = "Medias estimadas de DMR"
) +
theme_minimal(base_size = 13)
## Hay dif sig entre lineas? #sin relastivizar
DMR_Linea <- lmer(DMR ~ Línea + (1|Localidad) + (1|Año), data = crudos)
summary(DMR_Linea)
anova(DMR_Linea)  #Si
emm_lineas <- emmeans(DMR_Linea, ~ Línea) #contraste
pairs(emm_lineas, adjust = "tukey") #J7-L37 y J7-UF93
#grafiquito
emm_lineas <- emmeans(DMR_Linea, ~ Línea) # Medias estimadas de DMR por Línea
cld_lineas <- multcomp::cld(emm_lineas, Letters = letters, adjust = "tukey")
df_plot <- as.data.frame(cld_lineas)
ggplot(df_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias (DMR, predicho)",
title = "Medias estimadas de DMR por línea"
) +
theme_minimal(base_size = 13)
pairs(emm_lineas, adjust = "tukey") #J7-L37 y J7-UF93
pairs(Remm_lineas, adjust = "tukey") #J7-L37 y J7-UF93
## Hay dif entre localidades? # sin relativizar
# Modelo con Localidad como VE y Línea/Año como efectos aleatorios
modelo_loc <- lmer(DMR ~ Localidad + (1|Línea) + (1|Año), data = crudos)
# Medias estimadas de DMR por Localidad
emm_loc <- emmeans(modelo_loc, ~ Localidad)
# Comparaciones post hoc con letras
cld_loc <- multcomp::cld(emm_loc, Letters = letters, adjust = "tukey")
df_plot_loc <- as.data.frame(cld_loc)
# Paleta de colores (misma que antes, con tu modificación)
cols <- paletteer_d("ggthemes::excel_Depth")
cols_mod <- cols
cols_mod[2] <- cols[6]
# Gráfico
ggplot(df_plot_loc, aes(x = Localidad, y = emmean, fill = Localidad)) +
geom_col(color = "black") +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Localidad",
y = "Densidad de inflorescencias (DMR, predicho)",
title = "Medias estimadas de DMR por localidad"
) +
theme_minimal(base_size = 13)
#####                    MODELOS DMR                                    #######
## Hay dif sig entre lineas? #sin relastivizar ####
DMR_Linea <- <- glmmTMB(DMR ~ Línea + (1|Localidad) + (1|Año),
#####                    MODELOS DMR                                    #######
## Hay dif sig entre lineas? #sin relastivizar ####
DMR_Linea <-  glmmTMB(DMR ~ Línea + (1|Localidad) + (1|Año),
family = poisson, data = crudos)
res <- simulateResiduals(mod_linea)
res <- simulateResiduals(DMR_Linea)
plot(res)
# 3. Test de sobredispersión
testDispersion(res)
# 4. Test de cero-inflación (exceso de ceros)
testZeroInflation(res)
#####                    MODELOS DMR                                    #######
## Hay dif sig entre lineas? #sin relastivizar ####
DMR_Linea <-  glmmTMB(DMR ~ Línea + (1|Localidad) + (1|Año),
ziformula = ~1, family = poisson, data = crudos)
res <- simulateResiduals(DMR_Linea)
plot(res)
# 3. Test de sobredispersión
testDispersion(res)
#####                    MODELOS DMR                                    #######
## Hay dif sig entre lineas? #sin relastivizar ####
DMR_Linea <-  glmmTMB(DMR ~ Línea + (1|Localidad) + (1|Año),
ziformula = ~1, family = nbinom2, data = crudos)
res <- simulateResiduals(DMR_Linea)
plot(res)
# 3. Test de sobredispersión
testDispersion(res)
# 4. Test de cero-inflación (exceso de ceros)
testZeroInflation(res)
#supuestos
res <- simulateResiduals(DMR_Linea)
plot(res)
testDispersion(res)#  Test de sobredispersión
testZeroInflation(res)#  Test de cero-inflación (exceso de ceros)
summary(DMR_Linea)
anova(DMR_Linea)  #Si
pairs(emm_lineas, adjust = "tukey") #J7-L37 y J7-UF93
#grafiquito
emm_lineas <- emmeans(DMR_Linea, ~ Línea) # Medias estimadas de DMR por Línea
cld_lineas <- multcomp::cld(emm_lineas, Letters = letters, adjust = "tukey")
df_plot <- as.data.frame(cld_lineas)
ggplot(df_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias (DMR, predicho)",
title = "Medias estimadas de DMR por línea"
) +
theme_minimal(base_size = 13)
ggplot(df_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias (DMR, predicho)",
title = "Medias estimadas de DMR por línea"
) +
theme_minimal(base_size = 13)
#grafiquito
emm_lineas <- emmeans(DMR_Linea, ~ Línea) # Medias estimadas de DMR por Línea
cld_lineas <- multcomp::cld(emm_lineas, Letters = letters, adjust = "tukey")
df_plot <- as.data.frame(cld_lineas)
ggplot(df_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias (DMR, predicho)",
title = "Medias estimadas de DMR por línea"
) +
theme_minimal(base_size = 13)
summary(DMR_Linea)
anova(DMR_Linea)  #Si
emm_lineas <- emmeans(DMR_Linea, ~ Línea) #contraste
pairs(emm_lineas, adjust = "tukey") #J7-L37 y J7-UF93
#grafiquito
emm_lineas <- emmeans(DMR_Linea, ~ Línea) # Medias estimadas de DMR por Línea
cld_lineas <- multcomp::cld(emm_lineas, Letters = letters, adjust = "tukey")
df_plot <- as.data.frame(cld_lineas)
ggplot(df_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias (DMR, predicho)",
title = "Medias estimadas de DMR por línea"
) +
theme_minimal(base_size = 13)
## RELATIVIZADO A CANTIDAD DE PLANTULAS ####
REL_DMR_Linea <- glmmTMB(DMR ~ Línea + (1|Localidad) + (1|Año),
ziformula = ~1, family = nbinom2, data = relativos)
summary(REL_DMR_Linea)
anova(REL_DMR_Linea)  #Si
Rcld_lineas <- multcomp::cld(Remm_lineas, Letters = letters, adjust = "tukey")
Rdf_plot <- as.data.frame(Rcld_lineas)
ggplot(Rdf_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias relativizado a la cantidad de plantulas",
title = "Medias estimadas de DMR" ) + theme_minimal(base_size = 13)
summary(REL_DMR_Linea)
anova(REL_DMR_Linea)  #Si
Remm_lineas <- emmeans(REL_DMR_Linea, ~ Línea) #contraste
pairs(Remm_lineas, adjust = "tukey") #J7-L37 y J7-UF93 de peso se mantienen las dif. la k14-L37 en este caso es MARGINAL en el caso anterior no
## RELATIVIZADO A CANTIDAD DE PLANTULAS ####
REL_DMR_Linea <- glmmTMB(DMR ~ Línea + (1|Localidad) + (1|Año),
ziformula = ~1, family = poison, data = relativos)
summary(REL_DMR_Linea)
anova(REL_DMR_Linea)  #Si
Remm_lineas <- emmeans(REL_DMR_Linea, ~ Línea) #contraste
pairs(Remm_lineas, adjust = "tukey") #J7-L37 y J7-UF93 de peso se mantienen las dif. la k14-L37 en este caso es MARGINAL en el caso anterior no
#grafiquito
Remm_lineas <- emmeans(REL_DMR_Linea, ~ Línea) # Medias estimadas de DMR por Línea
Rcld_lineas <- multcomp::cld(Remm_lineas, Letters = letters, adjust = "tukey")
Rdf_plot <- as.data.frame(Rcld_lineas)
ggplot(Rdf_plot, aes(x = Línea, y = emmean, fill = Línea)) + geom_col(color = "black") + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, size = 0.8) +
geom_text(aes(label = .group, y = emmean + 5),   # ajustá el +5 según escala de DMR
size = 5) +
scale_fill_manual(values = cols_mod) +
labs(
x = "Línea",
y = "Densidad de inflorescencias relativizado a la cantidad de plantulas",
title = "Medias estimadas de DMR" ) + theme_minimal(base_size = 13)
